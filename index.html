<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Small Spells â€” LLM Drugs for Humans</title>
  <meta name="description" content="A curated, good-vibes-only collection of micro-texts engineered for wonder, warmth, and gentle perspective shifts. Static site. No server." />

  <!-- Open Graph -->
  <meta property="og:title" content="Small Spells â€” LLM Drugs for Humans" />
  <meta property="og:description" content="Micro-texts designed to create outsized wonder + warmth. No dread. Static site." />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="og.png" />
  <meta name="twitter:card" content="summary_large_image" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg0:#070A10;
      --bg1:#0A0F19;
      --border: rgba(255,255,255,.10);
      --text: #EAF0FF;
      --muted: rgba(234,240,255,.68);

      --c1:#00D4FF;
      --c2:#7AEEFF;
      --c3:#66F2B3;
      --c4:#FFD36B;

      --r16: 16px;
      --r20: 20px;
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --shadow2: 0 12px 30px rgba(0,0,0,.35);

      --mono: "JetBrains Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      --sans: "Inter", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: var(--sans);
      color: var(--text);
      background:
        radial-gradient(1200px 800px at 20% 10%, rgba(0,212,255,.16), transparent 55%),
        radial-gradient(900px 700px at 85% 15%, rgba(122,238,255,.12), transparent 55%),
        radial-gradient(1000px 800px at 55% 85%, rgba(102,242,179,.10), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: optimizeLegibility;
    }
    #bg{
      position:fixed; inset:0;
      width:100%; height:100%;
      z-index:-1;
      opacity:.85;
    }
    a{color:inherit; text-decoration:none}

    .wrap{
      max-width:680px;
      margin:0 auto;
      padding:0 20px;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
    }

    /* Header â€” always visible */
    header{
      position:fixed;
      top:0; left:0; right:0;
      padding:18px 20px;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:5;
    }
    .brand{display:flex; align-items:center; gap:12px; cursor:pointer}
    .logo{
      width:36px; height:36px; border-radius:12px;
      background:
        radial-gradient(14px 14px at 30% 30%, rgba(255,255,255,.30), transparent 55%),
        radial-gradient(22px 22px at 70% 70%, rgba(0,212,255,.25), transparent 60%),
        linear-gradient(135deg, rgba(0,212,255,.22), rgba(102,242,179,.18));
      border:1px solid rgba(255,255,255,.14);
      box-shadow: 0 10px 25px rgba(0,0,0,.35);
    }
    .brand-text{display:flex; align-items:center; gap:8px}
    .brand-name{font-size:18px; font-weight:700; letter-spacing:-.01em}
    .brand-sep{color: rgba(234,240,255,.25); font-weight:300; font-size:18px}
    .brand-sub{font-family: var(--mono); font-size:13px; color: var(--muted); letter-spacing:.04em}

    /* â”€â”€ Mood selector â”€â”€ */
    #mood-select{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:28px;
      text-align:center;
      animation: fadeUp .4s ease both;
    }
    .mood-title{
      margin:0;
      font-size:28px;
      font-weight:700;
      letter-spacing:-.03em;
      line-height:1.15;
    }
    .mood-sub{
      margin:0;
      color: var(--muted);
      font-size:14px;
      max-width:42ch;
    }
    .mood-grid{
      display:flex;
      flex-wrap:wrap;
      gap:12px;
      justify-content:center;
    }
    .mood-btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding:14px 22px;
      border-radius:999px;
      cursor:pointer;
      font-size:15px;
      font-family: var(--sans);
      display:inline-flex;
      align-items:center;
      gap:10px;
      transition: transform .1s ease, background .18s ease, border-color .18s ease, box-shadow .18s ease;
      user-select:none;
      white-space:nowrap;
    }
    .mood-btn:hover{
      background: rgba(255,255,255,.08);
      border-color: rgba(122,238,255,.22);
      box-shadow: 0 8px 32px rgba(0,0,0,.3);
    }
    .mood-btn:active{transform:scale(.97)}
    .mood-btn .mood-icon{font-size:18px}

    /* â”€â”€ Dose view â”€â”€ */
    #dose-view{
      display:none;
      flex-direction:column;
      align-items:center;
      gap:24px;
      text-align:center;
      max-width:600px;
      width:100%;
      animation: fadeUp .35s ease both;
    }
    #dose-view.active{display:flex}

    .dose-sub{
      margin:0;
      font-family: var(--mono);
      font-size:12px;
      color: rgba(234,240,255,.4);
      letter-spacing:.04em;
    }
    .dose-for{
      margin:0;
      font-size:15px;
      font-weight:500;
      color: var(--c2);
      letter-spacing:.02em;
    }
    .dose-text{
      margin:0;
      font-size:26px;
      font-weight:500;
      letter-spacing:-.02em;
      line-height:1.25;
      max-width:560px;
    }
    @media(min-width:600px){
      .dose-text{font-size:32px}
    }

    .dose-meta{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:center;
      align-items:center;
    }
    .tag{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.16);
      color: rgba(234,240,255,.66);
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      display:inline-flex;
      align-items:center;
      gap:6px;
      user-select:none;
    }
    .tag strong{color: rgba(234,240,255,.86); font-weight:600}
    .spark{color: var(--c2)}
    .leaf{color: var(--c3)}
    .sun{color: var(--c4)}

    .dose-actions{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
    }
    .btn{
      border:1px solid var(--border);
      background: rgba(255,255,255,.04);
      color: var(--text);
      padding:11px 18px;
      border-radius:999px;
      cursor:pointer;
      transition: transform .08s ease, background .15s ease, border-color .15s ease, box-shadow .15s ease;
      user-select:none;
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:13px;
      font-family: var(--sans);
      white-space:nowrap;
    }
    .btn:hover{background: rgba(255,255,255,.07)}
    .btn:active{transform:translateY(1px)}
    .btn.primary{
      background: linear-gradient(90deg, rgba(0,212,255,.20), rgba(122,238,255,.10));
      border-color: rgba(0,212,255,.28);
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
    }
    .btn.good{
      background: linear-gradient(90deg, rgba(102,242,179,.18), rgba(0,212,255,.09));
      border-color: rgba(102,242,179,.26);
    }

    .change-mood{
      margin-top:4px;
      background:none;
      border:none;
      color: var(--muted);
      cursor:pointer;
      font-size:12px;
      font-family: var(--mono);
      padding:6px 10px;
      border-radius:999px;
      transition: color .15s ease;
    }
    .change-mood:hover{color: var(--text)}

    .kbd-hints{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      justify-content:center;
      color: rgba(234,240,255,.35);
      font-size:11px;
      font-family: var(--mono);
    }
    @media(max-width:600px){
      .kbd-hints{display:none}
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:16px;
      transform: translateX(-50%) translateY(6px);
      padding:10px 12px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(10,14,22,.85);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow2);
      color: rgba(234,240,255,.92);
      font-size:13px;
      opacity:0;
      pointer-events:none;
      transition: opacity .16s ease, transform .16s ease;
      z-index: 60;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(0)}

    @keyframes fadeUp{
      from{opacity:0; transform:translateY(12px)}
      to{opacity:1; transform:translateY(0)}
    }
  </style>
</head>

<body>
  <canvas id="bg" aria-hidden="true"></canvas>

  <header>
    <a class="brand" href="#/" title="Home">
      <div class="logo" aria-hidden="true"></div>
      <div class="brand-text">
        <span class="brand-name">Small Spells</span>
        <span class="brand-sep">/</span>
        <span class="brand-sub">LLM Drugs for Humans</span>
      </div>
    </a>
  </header>

  <div class="wrap">
    <!-- Mood selector -->
    <div id="mood-select" style="display:none">
      <h1 class="mood-title">Pick a vibe</h1>
      <p class="mood-sub">Short strings that gently shift your state. No dread, no scary.</p>
      <div class="mood-grid">
        <button class="mood-btn" data-mood="Warmth"><span class="mood-icon">ðŸŒ¿</span> Warmth</button>
        <button class="mood-btn" data-mood="Wonder"><span class="mood-icon">âœ¦</span> Wonder</button>
        <button class="mood-btn" data-mood="Cosmic"><span class="mood-icon">âœ¦</span> Cosmic</button>
        <button class="mood-btn" data-mood="Gentle Shift"><span class="mood-icon">â˜¼</span> Gentle Shift</button>
        <button class="mood-btn" data-mood="All"><span class="mood-icon">âœ³</span> Surprise me</button>
      </div>
    </div>

    <!-- Dose view -->
    <div id="dose-view">
      <p class="dose-sub">State-shifting micro-texts. No dread, no scary.</p>
      <p class="dose-for" id="doseFor" hidden></p>
      <p class="dose-text" id="doseText"></p>
      <div class="dose-meta" id="doseMeta"></div>
      <div class="dose-actions">
        <button class="btn primary" id="nextBtn" type="button">Next</button>
        <button class="btn" id="copyBtn" type="button">Copy</button>
        <button class="btn good" id="shareBtn" type="button">Share</button>
        <button class="btn" id="doseBtn" type="button">Dose someone</button>
      </div>
      <button class="change-mood" id="changeMoodBtn" type="button">Pick a mood</button>
      <div class="kbd-hints">
        <span>Space / â†’ / N next</span>
        <span>C copy</span>
        <span>Esc back</span>
      </div>
    </div>
  </div>

  <div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script>
    const DOSES = [
      // Warmth
      { id:"dogs-dream", cat:"Warmth", tags:["dogs","love"], text:"Dogs dream about you." },
      { id:"laugh-signature", cat:"Warmth", tags:["joy","identity"], text:"Your laugh is a tiny signature no one else can forge." },
      { id:"two-strangers-laughing", cat:"Warmth", tags:["people","connection"], text:"Somewhere right now two strangers are laughing at the exact same thing for completely different reasons." },
      { id:"public-middle", cat:"Warmth", tags:["empathy","people"], text:"Everyone you see in public is in the middle of something." },
      { id:"recipe-memory", cat:"Warmth", tags:["food","memory"], text:"A recipe is just a memory you can eat." },
      { id:"favorite-song-stranger", cat:"Warmth", tags:["music","connection"], text:"Someone's favorite song exists because a stranger once felt something strongly." },
      { id:"future-best-friend", cat:"Warmth", tags:["friends","future"], text:"You've walked past someone's future best friend hundreds of times." },
      { id:"small-kindness", cat:"Warmth", tags:["kindness","ripple"], text:"A small kindness you forgot might still be living in someone's day." },
      { id:"pet-trust", cat:"Warmth", tags:["pets","trust"], text:"To a pet, you're a whole weather system of comfort." },
      { id:"shared-joke", cat:"Warmth", tags:["humor","connection"], text:"The same joke told in two cities can still land like a handshake." },
      { id:"someone-rooting", cat:"Warmth", tags:["support","hope"], text:"Someone is quietly rooting for you more than you realize." },
      { id:"handwritten-note", cat:"Warmth", tags:["care","details"], text:"A handwritten note is proof a thought took a physical form for you." },
      { id:"warm-light-window", cat:"Warmth", tags:["home","calm"], text:"Warm light in a window is a universal sign: someone's okay in there." },
      { id:"smile-echo", cat:"Warmth", tags:["social","ripple"], text:"A smile can be a tiny echo that makes a room softer." },
      { id:"found-object", cat:"Warmth", tags:["serendipity","joy"], text:"Finding a lost thing feels like the universe returning your call." },
      { id:"someone-thinking-kindly", cat:"Warmth", tags:["connection","soft"], text:"Somebody has thought of you with a quiet kind of gratitude." },
      { id:"inside-jokes-bridges", cat:"Warmth", tags:["friends","humor"], text:"Inside jokes are bridges only two people can see." },
      { id:"text-bubble", cat:"Warmth", tags:["communication","care"], text:"A message bubble is a tiny \u201cI\u2019m here\u201d you can hold." },
      { id:"tea-steam", cat:"Warmth", tags:["cozy","senses"], text:"Steam from a warm drink is comfort you can see." },
      { id:"fresh-sheets", cat:"Warmth", tags:["home","cozy"], text:"Fresh sheets feel like a reset button you can sleep in." },
      { id:"library-quiet", cat:"Warmth", tags:["books","calm"], text:"A library is a public place for quiet hope." },
      { id:"someone-made-bench", cat:"Warmth", tags:["humanity","craft"], text:"Someone made a bench once and now strangers get to rest." },
      { id:"door-held-open", cat:"Warmth", tags:["kindness","small"], text:"Holding a door open is a tiny vote for each other." },
      { id:"good-morning", cat:"Warmth", tags:["ritual","care"], text:"\u201cGood morning\u201d is a small spell people cast for each other." },
      { id:"cooking-smell", cat:"Warmth", tags:["home","food"], text:"The smell of cooking is a room practicing happiness." },
      { id:"socks-warm", cat:"Warmth", tags:["cozy","simple"], text:"Warm socks are underrated technology." },
      { id:"cat-slow-blink", cat:"Warmth", tags:["pets","trust"], text:"A slow blink from a cat is a compliment." },
      { id:"shared-umbrella", cat:"Warmth", tags:["care","weather"], text:"Sharing an umbrella is sharing a small world." },
      { id:"warm-mug-hands", cat:"Warmth", tags:["cozy","calm"], text:"A warm mug in your hands is a small, reliable promise." },
      { id:"favorite-spot", cat:"Warmth", tags:["home","comfort"], text:"You probably have a \u201cfavorite spot\u201d without meaning to." },
      { id:"soft-blanket", cat:"Warmth", tags:["cozy","rest"], text:"A soft blanket is a hug with no social obligations." },
      { id:"someone-saved-your-message", cat:"Warmth", tags:["care","memory"], text:"Someone has saved a message from you." },
      { id:"childhood-friend-remembers", cat:"Warmth", tags:["friends","memory"], text:"A childhood friend still remembers something you said that you\u2019ve forgotten." },
      { id:"stranger-directions", cat:"Warmth", tags:["kindness","people"], text:"A stranger once gave you directions and thought about you for a block after." },
      { id:"birthday-candles", cat:"Warmth", tags:["ritual","hope"], text:"Birthday candles are tiny fires that carry wishes into the air." },
      { id:"someone-learned-cook", cat:"Warmth", tags:["food","love"], text:"Someone learned to cook your favorite meal because it makes you happy." },
      { id:"grandparent-voice", cat:"Warmth", tags:["family","memory"], text:"You still carry the voice of someone who loved you early." },
      { id:"playlist-for-you", cat:"Warmth", tags:["music","care"], text:"Someone made a playlist with you in mind and never said so." },
      { id:"dog-waits-door", cat:"Warmth", tags:["dogs","love"], text:"A dog waits at a door not because it has to, but because it wants to." },
      { id:"laughing-until-crying", cat:"Warmth", tags:["joy","friends"], text:"Laughing until you cry is your body running out of ways to say \u2018this is good.\u2019" },
      { id:"old-shirt-comfort", cat:"Warmth", tags:["comfort","simple"], text:"That old shirt you keep wearing is soft because it\u2019s been loved that many times." },
      { id:"parent-watching-sleep", cat:"Warmth", tags:["family","calm"], text:"Someone once watched you sleep just to make sure you were okay." },
      { id:"voicemail-saved", cat:"Warmth", tags:["memory","love"], text:"Some people keep voicemails forever just to hear a voice again." },
      { id:"lullaby-chain", cat:"Warmth", tags:["music","family"], text:"The lullaby someone sang you was probably sung to them first." },
      { id:"left-porch-light", cat:"Warmth", tags:["home","care"], text:"Leaving a porch light on is a sentence without words." },
      { id:"nickname-affection", cat:"Warmth", tags:["language","love"], text:"A nickname is proof that someone thought about you enough to rename you." },
      { id:"apologizing-plant", cat:"Warmth", tags:["humor","care"], text:"People apologize to plants when they forget to water them. That\u2019s beautiful." },
      { id:"wave-from-car", cat:"Warmth", tags:["kindness","small"], text:"A wave from a passing car is a tiny handshake at speed." },
      { id:"someone-proud-secretly", cat:"Warmth", tags:["support","quiet"], text:"Someone is proud of you and hasn\u2019t found the right moment to say it." },

      // Wonder
      { id:"sun-chair", cat:"Wonder", tags:["nature","time"], text:"A tree spent decades turning sunlight into the chair you\u2019re sitting in." },
      { id:"rain-water", cat:"Wonder", tags:["water","cycle"], text:"Every cup of water you\u2019ve ever drunk has been rain at least once." },
      { id:"music-air", cat:"Wonder", tags:["music","sound"], text:"Every song you\u2019ve ever loved was just air vibrating in a pattern someone chose." },
      { id:"cloud-oceans", cat:"Wonder", tags:["clouds","nature"], text:"Clouds are oceans taking a walk." },
      { id:"plant-sun", cat:"Wonder", tags:["plants","sun"], text:"Somewhere, a plant is leaning toward the same sun you\u2019re seeing through a window." },
      { id:"paper-from-forest", cat:"Wonder", tags:["paper","trees"], text:"A book is a forest that learned to speak." },
      { id:"snowflake-time", cat:"Wonder", tags:["winter","detail"], text:"A snowflake is weather doing lacework." },
      { id:"mirror-soft", cat:"Wonder", tags:["perception","everyday"], text:"A mirror is light doing its best impression of you." },
      { id:"soap-bubbles", cat:"Wonder", tags:["physics","play"], text:"Bubbles are geometry practicing joy." },
      { id:"ink-thought", cat:"Wonder", tags:["writing","mind"], text:"Ink is a way for thoughts to stop being shy." },
      { id:"map-loveletter", cat:"Wonder", tags:["travel","hope"], text:"Every map is a love letter to places we wanted to reach." },
      { id:"coffee-beans", cat:"Wonder", tags:["coffee","world"], text:"Coffee is sunlight and rainfall translated into a morning." },
      { id:"fridge-hum", cat:"Wonder", tags:["home","sound"], text:"The quiet hum of a fridge is modern life keeping you company." },
      { id:"color-names", cat:"Wonder", tags:["language","color"], text:"Color names are agreements we make with the sky." },
      { id:"stairs-mountain", cat:"Wonder", tags:["movement","metaphor"], text:"Stairs are tiny mountains you can climb indoors." },
      { id:"shadow-time", cat:"Wonder", tags:["light","time"], text:"A shadow is a timestamp made of darkness." },
      { id:"rain-smell", cat:"Wonder", tags:["rain","senses"], text:"The smell after rain is the ground saying hello." },
      { id:"bread-alchemy", cat:"Wonder", tags:["food","craft"], text:"Bread is flour learning to be brave." },
      { id:"keys-small-music", cat:"Wonder", tags:["sound","objects"], text:"Keys jingling is a pocket-sized song." },
      { id:"photos-timecapsules", cat:"Wonder", tags:["photos","memory"], text:"Photos are time learning to sit still." },
      { id:"seed-instructions", cat:"Wonder", tags:["nature","growth"], text:"A seed contains instructions for a whole tree and that\u2019s absurdly cool." },
      { id:"spider-web-engineering", cat:"Wonder", tags:["nature","design"], text:"A spider builds architecture out of air." },
      { id:"ant-highways", cat:"Wonder", tags:["nature","systems"], text:"Ants run traffic systems with no signs." },
      { id:"pencil-wood", cat:"Wonder", tags:["objects","trees"], text:"A pencil is wood that learned to write." },
      { id:"glass-frozen-light", cat:"Wonder", tags:["materials","light"], text:"Glass is sand that decided to be transparent." },
      { id:"honey-sun", cat:"Wonder", tags:["bees","alchemy"], text:"Honey is sunlight stored in a jar." },
      { id:"ice-floating", cat:"Wonder", tags:["physics","water"], text:"Ice floats so lakes don\u2019t freeze solid. Nature chose mercy." },
      { id:"rainbows-agreement", cat:"Wonder", tags:["light","color"], text:"A rainbow is sunlight agreeing to show its parts." },
      { id:"whale-songs", cat:"Wonder", tags:["ocean","music"], text:"Some animals sing across entire miles of ocean." },
      { id:"fire-is-chemistry", cat:"Wonder", tags:["fire","everyday"], text:"Fire is chemistry making light in real time." },
      { id:"wind-in-trees", cat:"Wonder", tags:["sound","nature"], text:"Wind through trees is the planet humming." },
      { id:"timezones", cat:"Wonder", tags:["time","world"], text:"Somewhere it\u2019s tomorrow and someone is already laughing." },
      { id:"mail-is-teleport", cat:"Wonder", tags:["everyday","systems"], text:"Mail is low-speed teleportation for paper." },
      { id:"rubber-band-potential", cat:"Wonder", tags:["physics","play"], text:"A rubber band is stored-up motion waiting politely." },
      { id:"stairs-little-goals", cat:"Wonder", tags:["movement","mind"], text:"Small steps are how buildings teach you patience." },
      { id:"candle-sun", cat:"Wonder", tags:["light","craft"], text:"A candle is a domesticated piece of the sun." },
      { id:"bridges-arguments", cat:"Wonder", tags:["engineering","trust"], text:"Every bridge is an argument with gravity that humans keep winning." },
      { id:"clocks-agreements", cat:"Wonder", tags:["time","social"], text:"Clocks don\u2019t measure time\u2014they just help us agree about it." },
      { id:"soil-alive", cat:"Wonder", tags:["nature","hidden"], text:"A teaspoon of soil has more organisms than people on earth." },
      { id:"languages-evolve", cat:"Wonder", tags:["language","time"], text:"Every word you say was invented by someone who needed it to exist." },
      { id:"eyelashes-shields", cat:"Wonder", tags:["body","design"], text:"Your eyelashes are tiny shields that have been protecting you since day one." },
      { id:"elevator-music-silence", cat:"Wonder", tags:["music","social"], text:"Elevator music exists because silence between strangers felt too heavy." },
      { id:"ocean-lung", cat:"Wonder", tags:["ocean","breath"], text:"The ocean breathes twice a day. We call it tides." },
      { id:"fireflies-morse", cat:"Wonder", tags:["nature","light"], text:"Fireflies are writing love letters in morse code." },
      { id:"fossils-autographs", cat:"Wonder", tags:["time","nature"], text:"Fossils are autographs from creatures who were here first." },
      { id:"echo-loyal", cat:"Wonder", tags:["sound","physics"], text:"An echo is sound being loyal enough to come back." },
      { id:"compass-magnetic-friendship", cat:"Wonder", tags:["science","earth"], text:"A compass works because the planet has a magnetic personality." },
      { id:"clouds-weight", cat:"Wonder", tags:["clouds","physics"], text:"The average cloud weighs over a million pounds and still floats." },
      { id:"mushroom-network", cat:"Wonder", tags:["nature","connection"], text:"Trees send each other nutrients through underground fungal networks." },
      { id:"dandelion-wish-engine", cat:"Wonder", tags:["nature","play"], text:"A dandelion is a wish delivery system powered by breath." },
      { id:"birds-dinosaurs", cat:"Wonder", tags:["nature","time"], text:"Birds are dinosaurs that figured out how to stay." },
      { id:"old-buildings-memory", cat:"Wonder", tags:["buildings","time"], text:"Old buildings remember weather patterns in their walls." },

      // Cosmic
      { id:"night-old-light", cat:"Cosmic", tags:["stars","time"], text:"The night sky is old light arriving right on time." },
      { id:"star-cereal", cat:"Cosmic", tags:["light","stars"], text:"Light left a star a million years ago just to bounce off your cereal this morning." },
      { id:"atoms-exploded", cat:"Cosmic", tags:["atoms","stars"], text:"Every atom in you was once inside something that exploded." },
      { id:"photon-retina", cat:"Cosmic", tags:["photon","vision"], text:"A photon traveled uninterrupted across the universe and ended its journey on your retina." },
      { id:"universe-looking", cat:"Cosmic", tags:["universe","mind"], text:"You\u2019re a way for the universe to notice itself." },
      { id:"gravity-hug", cat:"Cosmic", tags:["gravity","ground"], text:"Gravity is the planet giving you a continuous hug." },
      { id:"earth-ship", cat:"Cosmic", tags:["earth","motion"], text:"You live on a spaceship made of rock and garden." },
      { id:"moon-calendar", cat:"Cosmic", tags:["moon","rhythm"], text:"The moon is a nightlight that also keeps time." },
      { id:"stardust-boring", cat:"Cosmic", tags:["awe","everyday"], text:"Stardust can become a grocery list and that\u2019s kind of incredible." },
      { id:"sun-quiet-work", cat:"Cosmic", tags:["sun","life"], text:"The sun has been quietly paying the bills for life all along." },
      { id:"space-between-not-empty", cat:"Cosmic", tags:["space","wonder"], text:"The space between stars isn\u2019t empty\u2014it\u2019s just very, very calm." },
      { id:"sky-ocean", cat:"Cosmic", tags:["sky","metaphor"], text:"The sky is an ocean you can breathe." },
      { id:"constellations-stories", cat:"Cosmic", tags:["stories","stars"], text:"Constellations are humans drawing stories on a dark canvas." },
      { id:"dawn-returns", cat:"Cosmic", tags:["morning","hope"], text:"Dawn is the universe reminding you it still does new." },
      { id:"oceans-moon", cat:"Cosmic", tags:["moon","ocean"], text:"The moon pulls the ocean like a gentle metronome." },
      { id:"comet-postcard", cat:"Cosmic", tags:["space","travel"], text:"A comet is a postcard from the early solar system." },
      { id:"aurora-dance", cat:"Cosmic", tags:["sky","science"], text:"Auroras are solar wind turning into a light show." },
      { id:"satellites-stars", cat:"Cosmic", tags:["modern","sky"], text:"Some \u2018stars\u2019 you see are machines helping humans talk." },
      { id:"sunrise-angle", cat:"Cosmic", tags:["morning","geometry"], text:"Sunrise is geometry doing something emotional." },
      { id:"you-stand-on-history", cat:"Cosmic", tags:["earth","time"], text:"You\u2019re standing on layers of time that turned into rock." },
      { id:"iron-in-blood", cat:"Cosmic", tags:["atoms","body"], text:"The iron in your blood was forged in a dying star." },
      { id:"speed-of-earth", cat:"Cosmic", tags:["earth","motion"], text:"You\u2019re moving at 67,000 miles per hour and haven\u2019t spilled your drink." },
      { id:"voyager-still-going", cat:"Cosmic", tags:["space","hope"], text:"Voyager 1 is still going and it\u2019s the loneliest thing humans ever made." },
      { id:"billion-heartbeats", cat:"Cosmic", tags:["body","time"], text:"Your heart has beaten about a billion times and never once asked for credit." },
      { id:"dark-matter-shy", cat:"Cosmic", tags:["space","mystery"], text:"Most of the universe is made of something we can\u2019t see. The cosmos is shy." },
      { id:"pale-blue-dot", cat:"Cosmic", tags:["earth","perspective"], text:"Everything that ever happened to anyone happened on a pale blue dot." },
      { id:"light-speed-patient", cat:"Cosmic", tags:["light","time"], text:"Light takes eight minutes to get here from the sun. It\u2019s patient like that." },
      { id:"elements-periodic-table", cat:"Cosmic", tags:["chemistry","wonder"], text:"Everything you\u2019ve ever touched is just 92 elements in different moods." },
      { id:"milky-way-side", cat:"Cosmic", tags:["galaxy","home"], text:"We live in the suburbs of the Milky Way and the commute is fine." },
      { id:"neutrinos-through-you", cat:"Cosmic", tags:["physics","body"], text:"Trillions of neutrinos pass through you every second without saying hello." },
      { id:"moon-drifting", cat:"Cosmic", tags:["moon","change"], text:"The moon is slowly drifting away. Even celestial bodies need space." },
      { id:"star-same-age", cat:"Cosmic", tags:["stars","connection"], text:"Some stars you see tonight are the same age as you." },
      { id:"universe-expanding-into", cat:"Cosmic", tags:["space","mystery"], text:"The universe is expanding but nobody knows into what." },
      { id:"supernova-elements", cat:"Cosmic", tags:["stars","creation"], text:"A supernova is destruction that creates everything interesting." },
      { id:"cosmic-background-hum", cat:"Cosmic", tags:["space","sound"], text:"The universe still hums with the echo of its own beginning." },

      // Gentle Shift
      { id:"bees-weather", cat:"Gentle Shift", tags:["bees","perspective"], text:"Bees have no idea we eat their honey. We\u2019re just weather to them." },
      { id:"fish-wet", cat:"Gentle Shift", tags:["awareness","lens"], text:"Fish don\u2019t know they\u2019re wet. You don\u2019t know what yours is." },
      { id:"theseus-music", cat:"Gentle Shift", tags:["time","identity"], text:"You\u2019re a ship of Theseus that still likes the same songs." },
      { id:"shared-air", cat:"Gentle Shift", tags:["breath","shared"], text:"The same air is taking turns being inside all of us." },
      { id:"language-word", cat:"Gentle Shift", tags:["language","feeling"], text:"There\u2019s a word in a language you don\u2019t speak that fits your feeling perfectly." },
      { id:"tiny-choices", cat:"Gentle Shift", tags:["agency","life"], text:"Your life is mostly made of tiny choices doing teamwork." },
      { id:"you-are-pattern", cat:"Gentle Shift", tags:["mind","calm"], text:"You are a pattern that learned to appreciate patterns." },
      { id:"attention-is-spotlight", cat:"Gentle Shift", tags:["attention","mind"], text:"Attention is a spotlight you can move, and that\u2019s a superpower." },
      { id:"nothing-is-just", cat:"Gentle Shift", tags:["meaning","wonder"], text:"Almost nothing is \u201cjust\u201d anything once you look closely." },
      { id:"weather-inside", cat:"Gentle Shift", tags:["emotion","self"], text:"A mood is weather, not a verdict." },
      { id:"future-is-plural", cat:"Gentle Shift", tags:["hope","future"], text:"The future is plural. More than one good outcome fits." },
      { id:"rest-is-productive", cat:"Gentle Shift", tags:["rest","health"], text:"Rest is not a pause from life; it\u2019s part of the engine." },
      { id:"slow-is-forward", cat:"Gentle Shift", tags:["progress","patience"], text:"Slow is still forward." },
      { id:"today-is-bridge", cat:"Gentle Shift", tags:["time","hope"], text:"Today is a bridge, not a cage." },
      { id:"permission-to-enjoy", cat:"Gentle Shift", tags:["joy","permission"], text:"You\u2019re allowed to enjoy things without earning them." },
      { id:"curiosity-kinder", cat:"Gentle Shift", tags:["curiosity","kindness"], text:"Curiosity is often kinder than certainty." },
      { id:"noticing-peace", cat:"Gentle Shift", tags:["mindfulness","calm"], text:"Noticing is already a kind of peace." },
      { id:"tiny-sunbeam", cat:"Gentle Shift", tags:["gratitude","small"], text:"A tiny sunbeam on a wall is the day waving at you." },
      { id:"boredom-creative", cat:"Gentle Shift", tags:["boredom","creativity"], text:"Boredom is your brain asking for a puzzle." },
      { id:"argument-care", cat:"Gentle Shift", tags:["conflict","love"], text:"People only argue with you because they haven\u2019t given up." },
      { id:"forgetting-names", cat:"Gentle Shift", tags:["memory","kindness"], text:"Forgetting someone\u2019s name doesn\u2019t mean you forgot them." },
      { id:"jealousy-compass", cat:"Gentle Shift", tags:["emotion","self"], text:"Jealousy is just desire wearing a disguise." },
      { id:"mistakes-data", cat:"Gentle Shift", tags:["growth","self"], text:"A mistake is just data with feelings attached." },
      { id:"routine-anchor", cat:"Gentle Shift", tags:["routine","calm"], text:"A routine is a kindness you do for your future self." },
      { id:"awkward-silence", cat:"Gentle Shift", tags:["social","peace"], text:"An awkward silence is two people agreeing not to perform." },
      { id:"changing-mind-strong", cat:"Gentle Shift", tags:["growth","strength"], text:"Changing your mind is one of the strongest things a mind can do." },
      { id:"crying-release", cat:"Gentle Shift", tags:["emotion","body"], text:"Crying is your body\u2019s way of letting pressure out through your eyes." },
      { id:"being-lost-exploring", cat:"Gentle Shift", tags:["perspective","adventure"], text:"Being lost is just exploring without a deadline." },
      { id:"comparison-thief", cat:"Gentle Shift", tags:["self","wisdom"], text:"Comparison is a camera that only photographs other people\u2019s highlight reels." },
      { id:"aging-collecting", cat:"Gentle Shift", tags:["time","self"], text:"Getting older is collecting evidence that you can survive things." },
      { id:"silence-answer", cat:"Gentle Shift", tags:["quiet","wisdom"], text:"Sometimes silence is the most honest answer." },
      { id:"procrastination-protection", cat:"Gentle Shift", tags:["self","mind"], text:"Procrastination is sometimes your brain protecting you from the wrong task." },
      { id:"asking-help-brave", cat:"Gentle Shift", tags:["courage","connection"], text:"Asking for help is a trust exercise disguised as a question." },
      { id:"nostalgia-proof", cat:"Gentle Shift", tags:["memory","gratitude"], text:"Nostalgia is proof that you\u2019ve had good times worth missing." },
      { id:"daydreaming-rehearsal", cat:"Gentle Shift", tags:["mind","creativity"], text:"Daydreaming is your brain rehearsing possibilities." }
    ];

    /* State */
    let screen = "mood";   // "mood" | "dose"
    let activeMood = null;
    let currentDose = null;
    let lastDoseId = null;
    let forName = null;

    /* DOM refs */
    const $moodSelect = document.getElementById("mood-select");
    const $doseView = document.getElementById("dose-view");
    const $doseFor = document.getElementById("doseFor");
    const $doseText = document.getElementById("doseText");
    const $doseMeta = document.getElementById("doseMeta");
    const $toast = document.getElementById("toast");

    /* Helpers */
    function toast(msg){
      $toast.textContent = msg;
      $toast.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(()=>$toast.classList.remove("show"), 1100);
    }

    function escapeHTML(s){
      return s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    function catIcon(cat){
      if(cat==="Warmth") return `<span class="leaf">\u{1F33F}</span>`;
      if(cat==="Cosmic") return `<span class="spark">\u2726</span>`;
      if(cat==="Gentle Shift") return `<span class="sun">\u263C</span>`;
      return `<span class="spark">\u2726</span>`;
    }

    function copyToClipboard(text){
      const ta = document.createElement("textarea");
      ta.value = text;
      ta.style.cssText = "position:fixed;left:-9999px";
      document.body.appendChild(ta);
      ta.select();
      document.execCommand("copy");
      ta.remove();
      toast("Copied");
    }

    function setHash(path){
      const next = "#"+path;
      if(location.hash !== next) history.replaceState(null, "", next);
    }

    /* Core logic */
    function getDosesForMood(mood){
      if(mood === "All") return DOSES;
      return DOSES.filter(d => d.cat === mood);
    }

    function showMoodSelector(){
      screen = "mood";
      activeMood = null;
      currentDose = null;
      $moodSelect.style.display = "";
      $doseView.classList.remove("active");
      // Re-trigger animation
      $moodSelect.style.animation = "none";
      $moodSelect.offsetHeight;
      $moodSelect.style.animation = "";
      setHash("/");
    }

    function showRandomDose(mood){
      const list = getDosesForMood(mood);
      if(!list.length) return;

      // Pick random, avoid repeating last
      let pick;
      if(list.length === 1){
        pick = list[0];
      } else {
        do {
          pick = list[Math.floor(Math.random() * list.length)];
        } while(pick.id === lastDoseId);
      }

      showDose(pick);
    }

    function showDose(dose){
      screen = "dose";
      currentDose = dose;
      lastDoseId = dose.id;

      $moodSelect.style.display = "none";
      $doseView.classList.add("active");

      // Re-trigger animation
      $doseView.style.animation = "none";
      $doseView.offsetHeight;
      $doseView.style.animation = "";

      if(forName){
        $doseFor.textContent = `${forName}, this one\u2019s for you`;
        $doseFor.hidden = false;
      } else {
        $doseFor.hidden = true;
      }

      $doseText.textContent = `\u201C${dose.text}\u201D`;

      const tagBits = [
        `<span class="tag">${catIcon(dose.cat)}<strong>${escapeHTML(dose.cat)}</strong></span>`,
        ...(dose.tags||[]).slice(0,3).map(t=>`<span class="tag">${escapeHTML(t)}</span>`)
      ].join("");
      $doseMeta.innerHTML = tagBits;

      setHash(`/dose/${dose.id}`);
    }

    function selectMood(mood){
      activeMood = mood;
      showRandomDose(mood);
    }

    function nextDose(){
      forName = null;
      if(!activeMood) activeMood = "All";
      showRandomDose(activeMood);
    }

    function shareDose(){
      if(!currentDose) return;
      const text = `\u201C${currentDose.text}\u201D`;
      const isWeb = location.protocol.startsWith("http");

      if(navigator.share){
        const payload = { title:"Small Spells", text };
        if(isWeb) payload.url = location.href;
        navigator.share(payload)
          .then(()=> toast("Shared"))
          .catch(()=>{});
        return;
      }

      copyToClipboard(isWeb ? `${text}\n${location.href}` : text);
    }

    function doseSomeone(){
      if(!currentDose) return;
      const name = prompt("Who's this dose for?");
      if(!name || !name.trim()) return;
      const clean = name.trim();
      const base = location.href.split("#")[0];
      const url = `${base}#/for/${encodeURIComponent(clean)}/${currentDose.id}`;
      copyToClipboard(url);
      toast("Link copied â€” send it!");
    }

    /* Event wiring */
    document.querySelectorAll(".mood-btn").forEach(btn => {
      btn.addEventListener("click", () => selectMood(btn.dataset.mood));
    });

    document.getElementById("nextBtn").addEventListener("click", nextDose);
    document.getElementById("copyBtn").addEventListener("click", () => {
      if(currentDose) copyToClipboard(currentDose.text);
    });
    document.getElementById("shareBtn").addEventListener("click", shareDose);
    document.getElementById("doseBtn").addEventListener("click", doseSomeone);
    document.getElementById("changeMoodBtn").addEventListener("click", showMoodSelector);

    document.querySelector(".brand").addEventListener("click", (e) => {
      e.preventDefault();
      showMoodSelector();
    });

    /* Keyboard shortcuts */
    window.addEventListener("keydown", (e) => {
      if(e.target.tagName === "INPUT" || e.target.tagName === "TEXTAREA") return;

      if(screen === "dose"){
        if(e.key === " " || e.key === "ArrowRight" || e.key.toLowerCase() === "n"){
          e.preventDefault();
          nextDose();
          return;
        }
        if(e.key.toLowerCase() === "c"){
          if(currentDose) copyToClipboard(currentDose.text);
          return;
        }
        if(e.key === "Escape"){
          showMoodSelector();
          return;
        }
      }
    });

    /* Hash routing */
    function applyRoute(){
      const h = (location.hash || "#/").slice(1);

      // #/for/Name/dose-id â€” personalized dose link
      const forMatch = h.match(/^\/for\/([^/]+)\/(.+)$/);
      if(forMatch){
        const name = decodeURIComponent(forMatch[1]);
        const id = forMatch[2];
        const dose = DOSES.find(x => x.id === id);
        if(dose){
          forName = name;
          activeMood = dose.cat;
          showDose(dose);
          return;
        }
      }

      if(h.startsWith("/dose/")){
        const id = h.split("/dose/")[1];
        const dose = DOSES.find(x => x.id === id);
        if(dose){
          forName = null;
          activeMood = dose.cat;
          showDose(dose);
          return;
        }
      }

      // Auto-show a random dose on first load
      forName = null;
      activeMood = "All";
      showRandomDose("All");
    }

    window.addEventListener("hashchange", applyRoute);

    /* Particle background */
    (function particles(){
      const canvas = document.getElementById("bg");
      const ctx = canvas.getContext("2d", { alpha:true });
      let w=0,h=0,dpr=1;
      const N = 110;
      const pts = [];
      const rnd = (a,b)=> a + Math.random()*(b-a);

      function resize(){
        dpr = Math.min(2, window.devicePixelRatio || 1);
        w = canvas.width = Math.floor(innerWidth * dpr);
        h = canvas.height = Math.floor(innerHeight * dpr);
        canvas.style.width = innerWidth + "px";
        canvas.style.height = innerHeight + "px";
      }
      function init(){
        pts.length = 0;
        for(let i=0;i<N;i++){
          pts.push({
            x: rnd(0,w), y: rnd(0,h),
            vx: rnd(-.18,.18)*dpr, vy: rnd(-.14,.14)*dpr,
            r: rnd(.6,1.6)*dpr,
            t: rnd(0,Math.PI*2)
          });
        }
      }
      function draw(){
        ctx.clearRect(0,0,w,h);

        const g = ctx.createLinearGradient(0,0,w,h);
        g.addColorStop(0, "rgba(0,212,255,0.05)");
        g.addColorStop(0.6, "rgba(122,238,255,0.03)");
        g.addColorStop(1, "rgba(102,242,179,0.04)");
        ctx.fillStyle = g;
        ctx.fillRect(0,0,w,h);

        for(const p of pts){
          p.t += 0.01;
          p.x += p.vx + Math.sin(p.t)*0.06*dpr;
          p.y += p.vy + Math.cos(p.t)*0.06*dpr;
          if(p.x<0) p.x=w; if(p.x>w) p.x=0;
          if(p.y<0) p.y=h; if(p.y>h) p.y=0;

          ctx.beginPath();
          ctx.arc(p.x,p.y,p.r,0,Math.PI*2);
          ctx.fillStyle = "rgba(234,240,255,0.45)";
          ctx.fill();
        }

        for(let i=0;i<pts.length;i++){
          for(let j=i+1;j<pts.length;j++){
            const a=pts[i], b=pts[j];
            const dx=a.x-b.x, dy=a.y-b.y;
            const dist=Math.sqrt(dx*dx+dy*dy);
            const max=130*dpr;
            if(dist<max){
              const alpha = (1 - dist/max) * 0.18;
              ctx.strokeStyle = `rgba(0,212,255,${alpha})`;
              ctx.lineWidth = 1*dpr;
              ctx.beginPath();
              ctx.moveTo(a.x,a.y);
              ctx.lineTo(b.x,b.y);
              ctx.stroke();
            }
          }
        }
        requestAnimationFrame(draw);
      }

      resize(); init(); draw();
      addEventListener("resize", ()=>{ resize(); init(); }, {passive:true});
    })();

    /* Boot */
    applyRoute();
  </script>
</body>
</html>
